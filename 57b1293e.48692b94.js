(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{119:function(e,t,n){"use strict";var r=n(0),i=n.n(r),o=n(130),u=n(427),c=n(425),a=n(428);t.a=(e={})=>{const{title:t="\u57fa\u7840\u7528\u6cd5",dsc:n="",example:r,code:l=""}=e;return i.a.createElement(u.a,null,r,i.a.createElement(c.a,{orientation:"left"},t),i.a.createElement("div",null,n),i.a.createElement(a.a,{expandIcon:()=>null,ghost:!0},i.a.createElement(a.a.Panel,{header:"</>",key:"1"},i.a.createElement(o.a.pre,null,i.a.createElement(o.a.code,{className:"language-jsx"},l)))))}},121:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return W})),n.d(t,"b",(function(){return C})),n.d(t,"c",(function(){return z})),n.d(t,"d",(function(){return Q})),n.d(t,"e",(function(){return G})),n.d(t,"f",(function(){return K})),n.d(t,"g",(function(){return M}));var r=n(0),i=n(132);var o=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},u="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},c="object"==typeof u&&u&&u.Object===Object&&u,a="object"==typeof self&&self&&self.Object===Object&&self,l=c||a||Function("return this")(),f=function(){return l.Date.now()},s=l.Symbol,v=Object.prototype,d=v.hasOwnProperty,m=v.toString,b=s?s.toStringTag:void 0;var p=function(e){var t=d.call(e,b),n=e[b];try{e[b]=void 0;var r=!0}catch(o){}var i=m.call(e);return r&&(t?e[b]=n:delete e[b]),i},y=Object.prototype.toString;var h=function(e){return y.call(e)},E=s?s.toStringTag:void 0;var g=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":E&&E in Object(e)?p(e):h(e)};var j=function(e){return null!=e&&"object"==typeof e};var O=function(e){return"symbol"==typeof e||j(e)&&"[object Symbol]"==g(e)},$=/^\s+|\s+$/g,w=/^[-+]0x[0-9a-f]+$/i,I=/^0b[01]+$/i,S=/^0o[0-7]+$/i,k=parseInt;var x=function(e){if("number"==typeof e)return e;if(O(e))return NaN;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace($,"");var n=I.test(e);return n||S.test(e)?k(e.slice(2),n?2:8):w.test(e)?NaN:+e},T=Math.max,R=Math.min;var A=function(e,t,n){var r,i,u,c,a,l,s=0,v=!1,d=!1,m=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function b(t){var n=r,o=i;return r=i=void 0,s=t,c=e.apply(o,n)}function p(e){return s=e,a=setTimeout(h,t),v?b(e):c}function y(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-s>=u}function h(){var e=f();if(y(e))return E(e);a=setTimeout(h,function(e){var n=t-(e-l);return d?R(n,u-(e-s)):n}(e))}function E(e){return a=void 0,m&&r?b(e):(r=i=void 0,c)}function g(){var e=f(),n=y(e);if(r=arguments,i=this,l=e,n){if(void 0===a)return p(l);if(d)return clearTimeout(a),a=setTimeout(h,t),b(l)}return void 0===a&&(a=setTimeout(h,t)),c}return t=x(t)||0,o(n)&&(v=!!n.leading,u=(d="maxWait"in n)?T(x(n.maxWait)||0,t):u,m="trailing"in n?!!n.trailing:m),g.cancel=function(){void 0!==a&&clearTimeout(a),s=0,r=l=i=a=void 0},g.flush=function(){return void 0===a?c:E(f())},g},C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Object(r.useRef)();i.current=e;var o=Object(r.useMemo)((function(){return A((function(){return i.current.apply(i,arguments)}),t,n)}),[]);return{run:o,cancel:o.cancel}};var N=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return o(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),A(e,t,{leading:r,maxWait:t,trailing:i})},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=Object(r.useRef)();i.current=e;var o=Object(r.useMemo)((function(){return N((function(){return i.current.apply(i,arguments)}),t,n)}),[]);return{run:o,cancel:o.cancel}};function B(e){if(e)return"function"==typeof e?e():"current"in e?e.current:e}var W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"click",i=Object(r.useRef)();i.current=e,Object(r.useEffect)((function(){var e=function(e){var n=B(t);n&&!n.contains(e.target)&&i.current(e)};return document.addEventListener(n,e),function(){document.removeEventListener(n,e)}}),[t])};function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var u,c=e[Symbol.iterator]();!(r=(u=c.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(a){i=!0,o=a}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(e,t)||P(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function L(e){return function(e){if(Array.isArray(e))return D(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||P(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){if(e){if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,t):void 0}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var U,q,J,X=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,(n=[{key:"$emit",value:function(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=[].concat(r),u=o[0],c=o.slice(1);e.subscriptions[u]&&"function"==typeof e.subscriptions[u]&&(t=e.subscriptions)[u].apply(t,L(c))}},{key:"$on",value:function(t,n){Object(r.useEffect)((function(){return e.subscriptions[t]||(e.subscriptions[t]=n),function(){e.subscriptions={}}}),[])}},{key:"$once",value:function(e,t){var n=this;n.$on(e,(function r(){n.$off(e,r),t.apply(n,arguments)}))}},{key:"$off",value:function(t){e.subscriptions[t]&&(e.subscriptions[t]=void 0)}}])&&F(t.prototype,n),i&&F(t,i),e}();J={},(q="subscriptions")in(U=X)?Object.defineProperty(U,q,{value:J,enumerable:!0,configurable:!0,writable:!0}):U[q]=J;var z=function(){return new X},G=function(e,t){var n=Object(r.useRef)(t),o=H(Object(r.useState)((function(){var t=B(e)||{};return{width:t.clientWidth,height:t.clientHeight}})),2),u=o[0],c=o[1];return Object(r.useLayoutEffect)((function(){var t=B(e);if(!t)return function(){};var r=new i.a((function(e){var t,r=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=P(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return u=e.done,e},e:function(e){c=!0,o=e},f:function(){try{u||null==n.return||n.return()}finally{if(c)throw o}}}}(e);try{var i=function(){var e=t.value;c((function(){return{width:e.target.clientWidth,height:e.target.clientHeight}})),n.current&&n.current({width:e.target.clientWidth,height:e.target.clientHeight})};for(r.s();!(t=r.n()).done;)i()}catch(o){r.e(o)}finally{r.f()}}));return r.observe(t),function(){r.disconnect()}}),[e]),u},K=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=Object(r.useRef)(),u=Object(r.useRef)();o.current=t,u.current=i;var c=Object(r.useRef)(!1);Object(r.useEffect)((function(){var t=B(e)||document;return t.addEventListener("scroll",(function(e){var t=e.target;t.scrollTop+t.clientHeight>=t.scrollHeight-n?c.current||(o.current&&o.current(e),u&&(c.current=!0)):c.current=!1})),function(){t&&t.removeEventListener("scroll",(function(){}))}}),[e])},Q=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,n=Object(r.useRef)(),i=Object(r.useRef)();return Object(r.useEffect)((function(){n.current=e})),Object(r.useEffect)((function(){if(null!=t)return i.current=setInterval((function(){n.current()}),t),function(){return i.current&&clearInterval(i.current)}}),[t]),{clearInterval:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){i.current&&clearInterval(i.current)}))}}}).call(this,n(29))},309:function(e,t,n){"use strict";n.r(t),t.default="import React, { useState } from 'react'\nimport { Button, Input } from 'antd'\nimport { useEventEmitter } from 'ihooks'\n\n\nconst FriendA = ({$eventEmitter = {}}) => {\n  \n\n  const handleInputChange = e => {\n    const val = e.target.value\n    $eventEmitter.$emit('onInput', val)\n    $eventEmitter.$emit('onceInput', val)\n  }\n\n  return (\n    <div>\n      <Input placeholder=\"\u8f93\u5165\u65f6\u89e6\u53d1$emit\"\n        onChange={e => handleInputChange(e)} />\n    </div>\n  )\n}\n\n\nconst FriendB = ({$eventEmitter = {}}) => {\n  const [onRes, seOnRes] = useState('')\n  const [onceRes, seOnceRes] = useState('')\n\n  const handleCancel = () => {\n    $eventEmitter.$off('onInput')\n  }\n\n  $eventEmitter.$on('onInput', val => {\n    seOnRes(val)\n  })\n\n  $eventEmitter.$once('onceInput', val => {\n    seOnceRes(val)\n  })\n\n  return (\n    <div>\n      <br/>\n      $on input value: {onRes}\n      <br/>\n      $once input value: {onceRes}\n      <br/>\n      <br/>\n      <Button onClick={handleCancel}>\u70b9\u51fb\u53d6\u6d88\u76d1\u542c</Button>\n    </div>\n  )\n}\n\n\nconst IuseEventEmitter = () => {\n  const $eventEmitter = useEventEmitter()\n\n  return (\n    <div>\n      <FriendA $eventEmitter={$eventEmitter} />\n      <FriendB $eventEmitter={$eventEmitter} />\n    </div>\n  )\n}\n\nexport default IuseEventEmitter\n"},91:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return h})),n.d(t,"metadata",(function(){return E})),n.d(t,"rightToc",(function(){return j})),n.d(t,"default",(function(){return $}));var r=n(2),i=n(6),o=n(0),u=n.n(o),c=n(112),a=n(119),l=n(429),f=n(199),s=n(121);const v=({$eventEmitter:e={}})=>u.a.createElement("div",null,u.a.createElement(l.a,{placeholder:"\u8f93\u5165\u65f6\u89e6\u53d1$emit",onChange:t=>(t=>{const n=t.target.value;e.$emit("onInput",n),e.$emit("onceInput",n)})(t)})),d=({$eventEmitter:e={}})=>{const[t,n]=Object(o.useState)(""),[r,i]=Object(o.useState)("");return e.$on("onInput",(e=>{n(e)})),e.$once("onceInput",(e=>{i(e)})),u.a.createElement("div",null,u.a.createElement("br",null),"$on input value: ",t,u.a.createElement("br",null),"$once input value: ",r,u.a.createElement("br",null),u.a.createElement("br",null),u.a.createElement(f.a,{onClick:()=>{e.$off("onInput")}},"\u70b9\u51fb\u53d6\u6d88\u76d1\u542c"))};var m=()=>{const e=Object(s.c)();return u.a.createElement("div",null,u.a.createElement(v,{$eventEmitter:e}),u.a.createElement(d,{$eventEmitter:e}))},b=n(426);const p=[{name:"$emit",dsc:"\u63a8\u9001\u4e00\u4e2a\u4e8b\u4ef6\u901a\u77e5",type:"function",default:"function (method, arg) {}",key:"1"},{name:"$on",dsc:"\u8ba2\u9605\u4e00\u4e2a\u4e8b\u4ef6\u901a\u77e5",type:"function",default:"function (method, val) {}",key:"2"},{name:"$once",dsc:"\u8ba2\u9605\u4e00\u6b21\u4e8b\u4ef6\u901a\u77e5",type:"function",default:"function (method, val) {}",key:"3"},{name:"$off",dsc:"\u53d6\u6d88\u8ba2\u9605\u4e8b\u4ef6\u901a\u77e5",type:"function",default:"function (method) {}",key:"4"}],y=[{title:"\u53c2\u6570",key:"name",dataIndex:"name"},{title:"\u8bf4\u660e",key:"dsc",dataIndex:"dsc"},{title:"\u7c7b\u578b",key:"type",dataIndex:"type"},{title:"\u9ed8\u8ba4",key:"default",dataIndex:"default"}];var h={id:"useEventEmitter",title:"useEventEmitter"},E={unversionedId:"useEventEmitter",id:"useEventEmitter",isDocsHomePage:!1,title:"useEventEmitter",description:"\u5728\u591a\u4e2a\u7ec4\u4ef6\u4e4b\u95f4\u8fdb\u884c\u4e8b\u4ef6\u901a\u77e5\u6709\u65f6\u4f1a\u5f88\u7e41\u7410\uff0c\u501f\u52a9 EventEmitter \uff0c\u53ef\u4ee5\u8ba9\u8fd9\u4e00\u8fc7\u7a0b\u53d8\u5f97\u66f4\u52a0\u7b80\u5355\u3002",source:"@site/docs/useEventEmitter.mdx",slug:"/useEventEmitter",permalink:"/docs/useEventEmitter",editUrl:"https://github.com/ximoThorn/ihooks/packages/website/docs/useEventEmitter.mdx",version:"current",sidebar:"someSidebar",previous:{title:"useScrollBottomCallback",permalink:"/docs/useScrollBottomCallback"}},g=n(309),j=[{value:"\u4ee3\u7801\u6f14\u793a",id:"\u4ee3\u7801\u6f14\u793a",children:[{value:"\u57fa\u7840\u7528\u6cd5",id:"\u57fa\u7840\u7528\u6cd5",children:[]},{value:"Result",id:"result",children:[]}]}],O={rightToc:j};function $(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(c.b)("wrapper",Object(r.a)({},O,n,{components:t,mdxType:"MDXLayout"}),Object(c.b)("p",null,"\u5728\u591a\u4e2a\u7ec4\u4ef6\u4e4b\u95f4\u8fdb\u884c\u4e8b\u4ef6\u901a\u77e5\u6709\u65f6\u4f1a\u5f88\u7e41\u7410\uff0c\u501f\u52a9 EventEmitter \uff0c\u53ef\u4ee5\u8ba9\u8fd9\u4e00\u8fc7\u7a0b\u53d8\u5f97\u66f4\u52a0\u7b80\u5355\u3002\n\u5728\u7ec4\u4ef6\u4e2d\u8c03\u7528 useEventEmitter \u53ef\u4ee5\u83b7\u5f97\u4e00\u4e2a EventEmitter \u7684\u5b9e\u4f8b\uff1a"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"// \u7ec4\u4ef6\u591a\u6b21\u6e32\u67d3\u65f6\uff0c\u5e76\u4e0d\u4f1a\u91cd\u590d\u521b\u5efa\u5b9e\u4f8b\nconst $eventEmitter = useEventEmitter()\n")),Object(c.b)("p",null,"\u901a\u8fc7 props \u6216\u8005 Context \uff0c\u53ef\u4ee5\u5c06 $eventEmitter \u5171\u4eab\u7ed9\u5176\u4ed6\u7ec4\u4ef6\u3002\u7136\u540e\u5728\u5176\u4ed6\u7ec4\u4ef6\u4e2d\uff0c\n\u53ef\u4ee5\u8c03\u7528 EventEmitter \u7684 emit \u65b9\u6cd5\uff0c\u63a8\u9001\u4e00\u4e2a\u4e8b\u4ef6\uff0c\u6216\u662f\u8c03\u7528 $on/$once \u65b9\u6cd5\uff0c\u8ba2\u9605\u4e8b\u4ef6\u3002\n\u6216\u662f\u8c03\u7528 $off \u65b9\u6cd5\uff0c\u53d6\u6d88\u8ba2\u9605\u4e8b\u4ef6\u3002"),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"$on\u4f1a\u5728\u7ec4\u4ef6\u9500\u6bc1\u65f6\uff0c\u53d6\u6d88\u8ba2\u9605")),Object(c.b)("h2",{id:"\u4ee3\u7801\u6f14\u793a"},"\u4ee3\u7801\u6f14\u793a"),Object(c.b)("h3",{id:"\u57fa\u7840\u7528\u6cd5"},"\u57fa\u7840\u7528\u6cd5"),Object(c.b)(a.a,{dsc:"",example:Object(c.b)(m,{mdxType:"IuseEventEmitter"}),code:g.default,mdxType:"FrameWrap"}),Object(c.b)("h3",{id:"result"},"Result"),Object(c.b)(b.a,{dataSource:p,columns:y,pagination:!1,mdxType:"Table"}))}$.isMDXComponent=!0}}]);